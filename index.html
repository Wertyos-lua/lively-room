<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=no">
<title>Lamp Switch</title>

<style>
html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: black;
}

/* Сцена */
#scene {
    position: relative;
    width: 100%;
    height: 100%;
    overflow: hidden;
}

/* Видео фон */
#video {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0;
    transition: opacity 0.6s ease;
    z-index: 0;
}

/* Чёрный фон */
#black {
    position: absolute;
    inset: 0;
    background: url("blackfone.png") center/cover no-repeat;
    opacity: 1;
    transition: opacity 0.6s ease;
    z-index: 1;
}

/* Лампа — левый верхний угол */
#lamp {
    position: absolute;
    top: 0;
    left: 0;

    width: 300px;
    height: 300px;

    background: url("lampoff.png") left top / contain no-repeat;
    z-index: 2;
    cursor: pointer;

    transform-origin: top left;
    transition: filter 0.6s ease;
}

/* Свечение */
#lamp.on {
    filter: drop-shadow(0 0 40px rgba(255,200,120,0.8));
}
</style>
</head>

<body>
<div id="scene">
    <video id="video" src="kuro.mp4" muted loop playsinline></video>
    <div id="black"></div>
    <div id="lamp"></div>
</div>

<script>
const lamp = document.getElementById("lamp");
const black = document.getElementById("black");
const video = document.getElementById("video");

let isOn = false;
let videoStarted = false;

/* Клик по лампе */
lamp.addEventListener("click", () => {
    isOn = !isOn;

    if (isOn) {
        if (!videoStarted) {
            video.play().catch(()=>{});
            videoStarted = true;
        }

        lamp.style.backgroundImage = "url('lampon.png')";
        lamp.classList.add("on");
        black.style.opacity = "0";
        video.style.opacity = "1";
    } else {
        lamp.style.backgroundImage = "url('lampoff.png')";
        lamp.classList.remove("on");
        black.style.opacity = "1";
        video.style.opacity = "0";
    }
});

/* Parallax */
let targetX = 0, targetY = 0;
let currentX = 0, currentY = 0;

function updateParallax() {
    currentX += (targetX - currentX) * 0.08;
    currentY += (targetY - currentY) * 0.08;
    lamp.style.transform = `translate(${currentX}px, ${currentY}px)`;
    requestAnimationFrame(updateParallax);
}
updateParallax();

/* Mouse */
window.addEventListener("mousemove", e => {
    targetX = (e.clientX / window.innerWidth - 0.5) * 12;
    targetY = (e.clientY / window.innerHeight - 0.5) * 12;
});

/* Touch */
window.addEventListener("touchmove", e => {
    const t = e.touches[0];
    targetX = (t.clientX / window.innerWidth - 0.5) * 12;
    targetY = (t.clientY / window.innerHeight - 0.5) * 12;
});

/* Gyroscope */
if (window.DeviceOrientationEvent) {
    window.addEventListener("deviceorientation", e => {
        if (e.gamma !== null && e.beta !== null) {
            targetX = e.gamma * 0.4;
            targetY = e.beta * 0.2;
        }
    });
}
</script>
</body>
</html>
