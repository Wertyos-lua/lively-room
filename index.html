<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=no">
<title>Lamp Switch</title>

<style>
html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: black;
}

#scene {
    position: relative;
    width: 100%;
    height: 100%;
    overflow: hidden;
}

/* Видео фон */
#video {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0;
    transition: opacity 0.6s ease;
    z-index: 0;
}

/* Чёрный фон */
#black {
    position: absolute;
    inset: 0;
    background: url("blackfone.png") center/cover no-repeat;
    opacity: 1;
    transition: opacity 0.6s ease;
    z-index: 1;
}

/* Лампа */
#lamp {
    position: absolute;
    inset: 0;
    background: url("lampoff.png") center/contain no-repeat;
    z-index: 2;
    cursor: pointer;
    transition: filter 0.6s ease;
}

/* Свечение включённой лампы */
.on {
    filter: drop-shadow(0 0 40px rgba(255,200,120,0.8));
}
</style>
</head>

<body>
<div id="scene">
    <video id="video" src="kuro.mp4" muted loop playsinline></video>
    <div id="black"></div>
    <div id="lamp"></div>
</div>

<script>
const lamp = document.getElementById("lamp");
const black = document.getElementById("black");
const video = document.getElementById("video");

let isOn = false;

/* Видео всегда играет, но скрыто */
video.play().catch(()=>{});

/* Toggle */
lamp.addEventListener("click", () => {
    isOn = !isOn;

    if (isOn) {
        lamp.style.backgroundImage = "url('lampon.png')";
        lamp.classList.add("on");
        black.style.opacity = "0";
        video.style.opacity = "1";
    } else {
        lamp.style.backgroundImage = "url('lampoff.png')";
        lamp.classList.remove("on");
        black.style.opacity = "1";
        video.style.opacity = "0";
    }
});

/* Parallax */
let targetX = 0, targetY = 0;
let currentX = 0, currentY = 0;

function updateParallax() {
    currentX += (targetX - currentX) * 0.08;
    currentY += (targetY - currentY) * 0.08;
    lamp.style.transform = `translate(${currentX}px, ${currentY}px)`;
    requestAnimationFrame(updateParallax);
}
updateParallax();

/* Mouse / touch */
window.addEventListener("mousemove", e => {
    targetX = (e.clientX / window.innerWidth - 0.5) * 30;
    targetY = (e.clientY / window.innerHeight - 0.5) * 30;
});

window.addEventListener("touchmove", e => {
    const t = e.touches[0];
    targetX = (t.clientX / window.innerWidth - 0.5) * 30;
    targetY = (t.clientY / window.innerHeight - 0.5) * 30;
});

/* Gyroscope */
if (window.DeviceOrientationEvent) {
    window.addEventListener("deviceorientation", e => {
        if (e.gamma !== null && e.beta !== null) {
            targetX = e.gamma * 0.8;
            targetY = e.beta * 0.4;
        }
    });
}
</script>
</body>
</html>
